---
  name: "Test Installation of KaaS-CLI"
  on:
    workflow_run:
      workflows: ["Lint Action"]
      types: 
        - completed

    workflow_dispatch:
  jobs:
    install-latest:
      runs-on: [ubuntu-latest]
      steps:
        - name: Checkout
          uses: actions/checkout@v4
  
        - name: Use Install Kontrol Action
          uses: ./
          with:
            version: latest

    install-no-parameter:
      runs-on: [ubuntu-latest]
      steps:
        - name: Checkout
          uses: actions/checkout@v4
  
        - name: Use Install Kontrol Action
          uses: ./
            
    install-specific:
      runs-on: [ubuntu-latest]
      steps:
        - name: Checkout
          uses: actions/checkout@v4
  
        - name: Use Install Kontrol Action
          uses: ./
          with:
            version: v0.1.227
  
        - name: Test kaas-cli
          shell: bash
          run: |
            kaas-cli --help

    dummy-proof-check:
      runs-on: [ubuntu-latest]
      needs: [install-latest, install-no-parameter, install-specific]
      steps:
        - name: Checkout
          uses: actions/checkout@v4

        - name: Install Kontrol
          uses: ./
          with:
            version: latest

        - name: Checkout Audit Template
          uses: actions/checkout@v4
          with:
            repository: "runtimeverification/audit-kontrol-template"
            ref: "master"
            path: "kontrol-template"

        - name: Dummy Proof Check
          shell: bash
          working-directory: kontrol-template
          run: |
            echo "Dummy Proof Check"
            echo "Run ./kontrol/run-kontrol.sh"